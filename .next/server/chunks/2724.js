"use strict";exports.id=2724,exports.ids=[2724],exports.modules={72724:(a,b,c)=>{c.r(b),c.d(b,{UploadComponent:()=>t});var d=c(68578),e=c(11999),f=c(7552),g=c(71144),h=c(9975),i=c(96447),j=c(21179),k=c(62345),l=c(2478),m=c(82239),n=c(64498),o=c(2840),p=c(92936),q=c(74500),r=c(11106),s={depth:0},t=a=>{let{className:b,data:{fields:c,relationTo:t,value:u},format:v,nodeKey:w}=a;if("object"==typeof u)throw Error("Upload value should be a string or number. The Lexical Upload component should not receive the populated value object.");let{config:{routes:{api:x},serverURL:y},getEntityConfig:z}=(0,l.c)(),A=(0,r.useRef)(null),{uuid:B}=(0,g.b)(),C=(0,m.useEditDepth)(),[D]=(0,i.DF)(),{editorConfig:E,fieldProps:{schemaPath:F}}=(0,g.b)(),G=(0,j.a)(),{i18n:H,t:I}=(0,n.d)(),[J,K]=(0,r.useReducer)(a=>a+1,0),[L]=(0,r.useState)(()=>z({collectionSlug:t})),M=(0,r.useId)(),N=(0,m.formatDrawerSlug)({slug:"lexical-upload-drawer-"+B+M,depth:C}),{toggleDrawer:O}=(0,e.a)(N,!0),{closeDocumentDrawer:P,DocumentDrawer:Q,DocumentDrawerToggler:R}=(0,f.a)({id:u,collectionSlug:L.slug}),[{data:S},{setParams:T}]=(0,m.usePayloadAPI)((0,p.Q)({apiRoute:x,path:`/${L.slug}/${u}`,serverURL:y}),{initialParams:s}),U=S?.thumbnailURL||S?.url,V=(0,r.useCallback)(()=>{D.update(()=>{(0,o.nsf)(w)?.remove()})},[D,w]),W=(0,r.useCallback)(a=>{T({...s,cacheBust:J}),K(),P()},[T,J,P]),X=E?.resolvedFeatureMap?.get("upload")?.sanitizedClientFeatureProps.collections?.[L.slug]?.hasExtraFields,Y=(0,r.useCallback)((a,b)=>{D.update(()=>{let a=(0,o.nsf)(w);if(a){let c={...a.getData(),fields:b};a.setData(c)}})},[D,w]),Z=U&&S?.width&&S?.height?S.width>S.height?"landscape":"portrait":"landscape";return(0,h.jsxs)("div",{className:`${b}__contents ${b}__contents--${Z}`,"data-align":v||void 0,"data-filename":S?.filename,ref:A,children:[(0,h.jsxs)("div",{className:`${b}__card`,children:[(0,h.jsxs)("div",{className:`${b}__media`,children:[(0,h.jsx)(m.Thumbnail,{collectionSlug:t,fileSrc:(0,q.w)(S?.mimeType)?U:null,height:S?.height,size:"none",width:S?.width}),G&&(0,h.jsx)("div",{className:`${b}__overlay ${b}__floater`,children:(0,h.jsxs)("div",{className:`${b}__actions`,role:"toolbar",children:[X?(0,h.jsx)(m.Button,{buttonStyle:"icon-label",className:`${b}__upload-drawer-toggler`,disabled:!G,el:"button",icon:"edit",onClick:O,round:!0,size:"medium",tooltip:I("fields:editRelationship")}):null,(0,h.jsx)(m.Button,{buttonStyle:"icon-label",className:`${b}__swap-drawer-toggler`,disabled:!G,el:"button",icon:"swap",onClick:()=>{D.dispatchCommand(d.b,{replace:{nodeKey:w}})},round:!0,size:"medium",tooltip:I("fields:swapUpload")}),(0,h.jsx)(m.Button,{buttonStyle:"icon-label",className:`${b}__removeButton`,disabled:!G,icon:"x",onClick:a=>{a.preventDefault(),V()},round:!0,size:"medium",tooltip:I("fields:removeUpload")})]})})]}),(0,h.jsxs)("div",{className:`${b}__metaOverlay ${b}__floater`,children:[(0,h.jsx)(R,{className:`${b}__doc-drawer-toggler`,children:(0,h.jsx)("strong",{className:`${b}__filename`,children:S?.filename||I("general:untitled")})}),(0,h.jsx)("div",{className:`${b}__collectionLabel`,children:(0,k.s)(L.labels.singular,H)})]})]}),u?(0,h.jsx)(Q,{onSave:W}):null,X?(0,h.jsx)(d.a,{data:c,drawerSlug:N,drawerTitle:I("general:editLabel",{label:(0,k.s)(L.labels.singular,H)}),featureKey:"upload",handleDrawerSubmit:Y,schemaPath:F,schemaPathSuffix:L.slug}):null]})}}};